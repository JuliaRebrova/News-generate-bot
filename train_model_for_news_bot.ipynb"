{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"Копия блокнота \"NEWS.ipynb\"","provenance":[{"file_id":"1uTTbp6wRQ7HwJf4FS0yqhrcScpDIkWsO","timestamp":1643186974639}],"collapsed_sections":["RxHc_Sj1G5hu","nXUXOqN0RzJd"],"authorship_tag":"ABX9TyMNyPcGw8mwitzez2S/lV37"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"e6432927284d475ca29d0e61df264ca1":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_ce0caad5736846be881fa1793295b4ee","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_c6361020909d400eb6c1694ad09fced1","IPY_MODEL_1b730d7709854e5392593efa6d619b4d","IPY_MODEL_915f9491ee4c4aa1be7fec6a08f70d1b"]}},"ce0caad5736846be881fa1793295b4ee":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c6361020909d400eb6c1694ad09fced1":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_6e8b1f900a584f7e9841768cc1c821a5","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"acc 0.0047 loss 3.9690: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_4f667b0ea4184022a7ce7741003b5436"}},"1b730d7709854e5392593efa6d619b4d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_976f967365a744eda02f9b7bf06489a1","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":7,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":7,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b131c9e7992a4e97a941b1e7e41daafe"}},"915f9491ee4c4aa1be7fec6a08f70d1b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_f258f80b73074820ad2d53c6a5e2dbce","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 7/7 [00:00&lt;00:00,  8.17it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_97863e4db82f4c5a901cd6b3647393c2"}},"6e8b1f900a584f7e9841768cc1c821a5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"4f667b0ea4184022a7ce7741003b5436":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"976f967365a744eda02f9b7bf06489a1":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"b131c9e7992a4e97a941b1e7e41daafe":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f258f80b73074820ad2d53c6a5e2dbce":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"97863e4db82f4c5a901cd6b3647393c2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3a074c39665b4ab7afdfcf3169053737":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_c4c5c7f9bf7347549b2b9ff06b23d312","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_9dec1d0a81214442b62fc090be53a4a8","IPY_MODEL_3d7b556f993e4181a445f822550d588d","IPY_MODEL_9d41bb76c2104022bfd1bd3ec76845b0"]}},"c4c5c7f9bf7347549b2b9ff06b23d312":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9dec1d0a81214442b62fc090be53a4a8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_e1aa85ac42714d0db021b1030dcf759f","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"acc 0.0061 loss 2.8877: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_5cd1698d0e3f4880a0f8a751abe894b1"}},"3d7b556f993e4181a445f822550d588d":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_d01863b32134474bbe965b6d733b1d5a","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3c3cc5eb003d4099977a7cee18d52e63"}},"9d41bb76c2104022bfd1bd3ec76845b0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_7556c8a9e80b481f9cfb0db0d349a777","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1/1 [00:00&lt;00:00, 12.86it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3cc622da64c14e4db211bbb583eac748"}},"e1aa85ac42714d0db021b1030dcf759f":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"5cd1698d0e3f4880a0f8a751abe894b1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d01863b32134474bbe965b6d733b1d5a":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"3c3cc5eb003d4099977a7cee18d52e63":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7556c8a9e80b481f9cfb0db0d349a777":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"3cc622da64c14e4db211bbb583eac748":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"3cec1ec6a68846cea980bf92e9076c5d":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_47cbff0f8de44184a7e387b9da9325fd","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_5607dd1454764abeb2c2c5e961ae6e2c","IPY_MODEL_e1b09b75670444a6a4a799e1746c74af","IPY_MODEL_0243958fafe54587a9da96ad88cd19e0"]}},"47cbff0f8de44184a7e387b9da9325fd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"5607dd1454764abeb2c2c5e961ae6e2c":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_1194b9d54a5e42dfb7d38d880b0ae203","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"acc 0.0073 loss 3.6486: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b4c3a768d6544585ae95dfe593c9492a"}},"e1b09b75670444a6a4a799e1746c74af":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_db1e1a2ef3ba4d53b457838c8a0730db","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":7,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":7,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b1ede558fa4f483ba14b55b0a38f166d"}},"0243958fafe54587a9da96ad88cd19e0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_a825d8517ebb43ec9633ea12e0e9c4f6","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 7/7 [00:00&lt;00:00,  8.04it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_55a118a1b4b844e4a6d9cc6835684239"}},"1194b9d54a5e42dfb7d38d880b0ae203":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"b4c3a768d6544585ae95dfe593c9492a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"db1e1a2ef3ba4d53b457838c8a0730db":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"b1ede558fa4f483ba14b55b0a38f166d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a825d8517ebb43ec9633ea12e0e9c4f6":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"55a118a1b4b844e4a6d9cc6835684239":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"00aa5e4d12ef4a409b9f67f52c861de7":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_1f87eccd4d7f4d8c8ca4a792b682102c","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_4553a257f14243a591c1e8e4d9e7b272","IPY_MODEL_fc4d0393a43d4a90966be405f6425ebb","IPY_MODEL_4dff0b2149c74ea299f2caf17a215d2f"]}},"1f87eccd4d7f4d8c8ca4a792b682102c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4553a257f14243a591c1e8e4d9e7b272":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_57dc94672e8243d7bc36e2e99757148d","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"acc 0.0061 loss 2.8144: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_006bf08077ab4750b1a9c4bf044c68e7"}},"fc4d0393a43d4a90966be405f6425ebb":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_ad4c9192ee4843a9a0b1f14313b194ef","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_fe73e1cc0ffd4d11b99ed435f7acc297"}},"4dff0b2149c74ea299f2caf17a215d2f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_d653ce6bae9847c995b1f3dec2fd3221","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1/1 [00:00&lt;00:00, 15.13it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_3e4078e176b64d81b72c510da2771b03"}},"57dc94672e8243d7bc36e2e99757148d":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"006bf08077ab4750b1a9c4bf044c68e7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ad4c9192ee4843a9a0b1f14313b194ef":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"fe73e1cc0ffd4d11b99ed435f7acc297":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"d653ce6bae9847c995b1f3dec2fd3221":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"3e4078e176b64d81b72c510da2771b03":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e6a6e70941b84cefa7dd01b9f8b9d89a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_e93f06e670524af6a5a11dae1ed8ff00","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_28999912d33c42a688913b9f4a6dd7b9","IPY_MODEL_7bac386fc9fc46ef8897bc4cfc71c59e","IPY_MODEL_06d77554ed9e448292584ed28685ec60"]}},"e93f06e670524af6a5a11dae1ed8ff00":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"28999912d33c42a688913b9f4a6dd7b9":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_239502f34acb458ca668c5b96d3ac1be","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"acc 0.0067 loss 3.4639: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c769e9dab473400e8064c40247fda7cf"}},"7bac386fc9fc46ef8897bc4cfc71c59e":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_6eeb5391803440d6a3b6745ca1ac0263","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":7,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":7,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_bec07ad667a74c6ca6c2e2e395478de1"}},"06d77554ed9e448292584ed28685ec60":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_0e26bf40d7484edfac4dc2eb90044852","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 7/7 [00:00&lt;00:00,  8.25it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a202c59f852047b0afe48b9a77b09629"}},"239502f34acb458ca668c5b96d3ac1be":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"c769e9dab473400e8064c40247fda7cf":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6eeb5391803440d6a3b6745ca1ac0263":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"bec07ad667a74c6ca6c2e2e395478de1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"0e26bf40d7484edfac4dc2eb90044852":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"a202c59f852047b0afe48b9a77b09629":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"e8df68e4d64c49d5929219d75d601467":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_1ef184d4694b43aab4768e221145a8b6","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_c594dee71a04497688cc4429706c7938","IPY_MODEL_e125247918d447de9bad39050ae52b91","IPY_MODEL_c8e7dc4ccd2a409fba637d0828c0a9aa"]}},"1ef184d4694b43aab4768e221145a8b6":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c594dee71a04497688cc4429706c7938":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_43408246c7804197bb8298535bb3ffe0","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"acc 0.0082 loss 2.7828: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_cf5c90e43c144b76b7f1eeeac55c282b"}},"e125247918d447de9bad39050ae52b91":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_4b523ec8d8bd4dda82b6e3a3c53c8eb8","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_5960f5d736ee4253bf9409caa8c2f270"}},"c8e7dc4ccd2a409fba637d0828c0a9aa":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_044ca029f3d54e7495881188613b9e13","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1/1 [00:00&lt;00:00, 14.99it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_aea82bf27fbb47afba1dbbfd933e0cd7"}},"43408246c7804197bb8298535bb3ffe0":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"cf5c90e43c144b76b7f1eeeac55c282b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"4b523ec8d8bd4dda82b6e3a3c53c8eb8":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"5960f5d736ee4253bf9409caa8c2f270":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"044ca029f3d54e7495881188613b9e13":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"aea82bf27fbb47afba1dbbfd933e0cd7":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7a6f0a3b3f0a4819899d057f2fe87326":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_b26b9794cf654e09bd56724985f63a0d","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_70264fe3121b4058991a4abba5f86222","IPY_MODEL_da3788d2846846c0a642f3498f84bd63","IPY_MODEL_c858791b1639443ea36ad39de9e5de95"]}},"b26b9794cf654e09bd56724985f63a0d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"70264fe3121b4058991a4abba5f86222":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_4b73f0bd8941433e82ef70b3a81ef0ad","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"acc 0.0061 loss 3.3956: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d4fa3bc9c24a4806ab22297b93d54989"}},"da3788d2846846c0a642f3498f84bd63":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_559683dc66b64ceb971915c6cee644a3","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":7,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":7,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_19195a2345e240e69031bede8aec60b1"}},"c858791b1639443ea36ad39de9e5de95":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_03ef2ae4fe424cc6b618e062b97632d8","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 7/7 [00:00&lt;00:00,  8.03it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8253780cd8134b029df83342b96ce0c9"}},"4b73f0bd8941433e82ef70b3a81ef0ad":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"d4fa3bc9c24a4806ab22297b93d54989":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"559683dc66b64ceb971915c6cee644a3":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"19195a2345e240e69031bede8aec60b1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"03ef2ae4fe424cc6b618e062b97632d8":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"8253780cd8134b029df83342b96ce0c9":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"a23bb759c7b3456fa0fb0478e28de9bd":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_9ca9dfda91b445a28b9dfab44b6b505c","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_ad840afae12b4189b43d3467222f8531","IPY_MODEL_ab4648d3aa674e55be882d7f3b1db1a1","IPY_MODEL_e7259b0fcf6841a291aa57f17eea5cb8"]}},"9ca9dfda91b445a28b9dfab44b6b505c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"ad840afae12b4189b43d3467222f8531":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_f1e0ef2a3411411e8583afed3f5ebaec","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"acc 0.0082 loss 2.7711: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_60f906f725da4908a7925f8554768232"}},"ab4648d3aa674e55be882d7f3b1db1a1":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_2703a5a078b84c418371cc1ace988bd1","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ee0ab8ff18354c4eac9e14787866d045"}},"e7259b0fcf6841a291aa57f17eea5cb8":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_31ff9478e1f14dd7a83b1fca70d51888","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1/1 [00:00&lt;00:00, 14.41it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_2d9bcd5a8243454fa87c466cbdfc9d4a"}},"f1e0ef2a3411411e8583afed3f5ebaec":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"60f906f725da4908a7925f8554768232":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"2703a5a078b84c418371cc1ace988bd1":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"ee0ab8ff18354c4eac9e14787866d045":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"31ff9478e1f14dd7a83b1fca70d51888":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"2d9bcd5a8243454fa87c466cbdfc9d4a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"7e5a5dd4c84a4c3ebabea557b12bc16a":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_7e8d4e8dae614f178a523c37ed16a8b5","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_00f0ac2385274792a129c45e9cb64775","IPY_MODEL_abcc8a1174c14f769089d53703e48f75","IPY_MODEL_c87c242cf5b6411b8e7cedab90aff89f"]}},"7e8d4e8dae614f178a523c37ed16a8b5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"00f0ac2385274792a129c45e9cb64775":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_1a04c7f6b29b4916bc4555bfffb60767","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"acc 0.0067 loss 3.3461: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_97ab9afa45cf4d04888448147417071d"}},"abcc8a1174c14f769089d53703e48f75":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_56f810a6db9c47968c1c061799e26e4e","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":7,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":7,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_70b289155d414dc2a4f44375617aab89"}},"c87c242cf5b6411b8e7cedab90aff89f":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_c7bc9745df1e4c9d90c987b48c5850a5","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 7/7 [00:00&lt;00:00,  8.27it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_c2a6a13e1b2c464bbee8ecae1c7de7c0"}},"1a04c7f6b29b4916bc4555bfffb60767":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"97ab9afa45cf4d04888448147417071d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"56f810a6db9c47968c1c061799e26e4e":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"70b289155d414dc2a4f44375617aab89":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c7bc9745df1e4c9d90c987b48c5850a5":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"c2a6a13e1b2c464bbee8ecae1c7de7c0":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"9469a2d414404ac48d059632789b0ac3":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_190b00b2193a4750ad630b3d160908b3","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_1046cfacc8c64b298dab259c4f8313f2","IPY_MODEL_3c02422a74b34b6898f7ee986d7f01bd","IPY_MODEL_52fc041d8d864791a5b82403ba376d54"]}},"190b00b2193a4750ad630b3d160908b3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"1046cfacc8c64b298dab259c4f8313f2":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_755e18cd91fe44d0917eb85b2c40dd7a","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":"acc 0.0082 loss 2.7678: 100%","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_98219781b6d64d6fb3e69fe9c6b10595"}},"3c02422a74b34b6898f7ee986d7f01bd":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_view_name":"ProgressView","style":"IPY_MODEL_48dca50b8e5549ce8650bf4933ad7b56","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_fa1374f240354105a28704b12e6e24cd"}},"52fc041d8d864791a5b82403ba376d54":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_view_name":"HTMLView","style":"IPY_MODEL_c0e353aafba74482b936323187e66b4b","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 1/1 [00:00&lt;00:00, 15.08it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_a8516e26c029447e99f1d3bd806115db"}},"755e18cd91fe44d0917eb85b2c40dd7a":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"98219781b6d64d6fb3e69fe9c6b10595":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"48dca50b8e5549ce8650bf4933ad7b56":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"fa1374f240354105a28704b12e6e24cd":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"c0e353aafba74482b936323187e66b4b":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"a8516e26c029447e99f1d3bd806115db":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","source":["# Imports"],"metadata":{"id":"_K_ibVaEG0Xp"}},{"cell_type":"code","source":["!pip install transformers"],"metadata":{"id":"OFaDjtGgcjvb"},"execution_count":null,"outputs":[]},{"cell_type":"code","execution_count":null,"metadata":{"id":"4vR6C_atFqEN"},"outputs":[],"source":["from bs4 import BeautifulSoup\n","import requests\n","import re\n","import pandas as pd\n"]},{"cell_type":"code","source":["import numpy as np\n","import pandas as pd\n","import re\n","import random\n","\n","import torch\n","from tqdm.notebook import tqdm\n","import transformers\n","\n","if torch.cuda.is_available():    \n","    device = torch.device(\"cuda\")\n","else:\n","    device = torch.device(\"cpu\")\n"],"metadata":{"id":"RE8a0gyXGsV1"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from transformers import GPT2Tokenizer\n","tokenizer = GPT2Tokenizer.from_pretrained('sberbank-ai/rugpt3small_based_on_gpt2')"],"metadata":{"id":"L9wOgzq5Gv5t"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import re"],"metadata":{"id":"FqSlVdzcGyaS"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ATBToDsTGfKv","executionInfo":{"status":"ok","timestamp":1639142677174,"user_tz":-180,"elapsed":2270,"user":{"displayName":"Юлия Реброва","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiY2K6Fih802Mm_DFM09AvsLU6dMgzrZvTtTbmSug=s64","userId":"11804329915006949566"}},"outputId":"30c73daa-47fd-4c18-80fe-9c7247866d19"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}]},{"cell_type":"markdown","source":["# Functions"],"metadata":{"id":"RxHc_Sj1G5hu"}},{"cell_type":"code","source":["def clean_br(text): \n","    text = re.sub(r'<h2 class=\"mg-card__title\">+', \" \", text)\n","    text = re.sub(r'</h2>+','.',text)\n","    text = re.sub('\\n', '', text)\n","    return text"],"metadata":{"id":"1qnFNGfPFxiX"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def del_xa(text):\n","\n","    text = re.sub(r'\\xa0', \" \", text)\n","\n","    return text"],"metadata":{"id":"nNopHKYpF512"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["def clean(lst):  \n","  for i in range(len(lst)):\n","    lst[i] = str(lst[i])[(str(lst[i]).index('>')+1):(str(lst[i]).rindex('<'))]\n"],"metadata":{"id":"bzg0XgaAF5zN"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["# Data"],"metadata":{"id":"4-2sHeQQG8d2"}},{"cell_type":"markdown","source":["Unpacking the data"],"metadata":{"id":"KMTnM9FKlclO"}},{"cell_type":"code","source":["!unzip /content/drive/MyDrive/Colab_Notebooks/news/news_1.zip # change the path"],"metadata":{"id":"LX4mIn4VF5w-"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["econ = pd.read_csv('/content/news_1/econ')\n","econ = list(econ.iloc[:,1])\n","clean(econ)\n","for i in range(len(econ)):\n","  econ[i] = clean_br(econ[i]).strip()"],"metadata":{"id":"2KqYwF6jGVU8"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["polit = pd.read_csv('/content/news_1/polit')\n","polit = list(polit.iloc[:,1])\n","clean(polit)\n","for i in range(len(polit)):\n","  polit[i] = clean_br(polit[i]).strip()"],"metadata":{"id":"3xB9FHn2Jqqp"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["sc = pd.read_csv('/content/news_1/sc')\n","sc = list(sc.iloc[:,1])\n","clean(sc)\n","for i in range(len(sc)):\n","  sc[i] = clean_br(sc[i]).strip()"],"metadata":{"id":"GKTTM8D0KOH1"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["sp = pd.read_csv('/content/news_1/sp')\n","sp = list(sp.iloc[:,1])\n","clean(sp)\n","for i in range(len(sp)):\n","  sp[i] = clean_br(sp[i]).strip()"],"metadata":{"id":"I2st86ldKZpc"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["all_news = ' '.join(polit) + ' '.join(econ) + ' '.join(sc) + ' '.join(sp)"],"metadata":{"id":"tYMh8xqqMNv5"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["len(all_news)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"pU8i1AzmMmG9","executionInfo":{"status":"ok","timestamp":1639142701429,"user_tz":-180,"elapsed":6,"user":{"displayName":"Юлия Реброва","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiY2K6Fih802Mm_DFM09AvsLU6dMgzrZvTtTbmSug=s64","userId":"11804329915006949566"}},"outputId":"a1133946-0c89-4f33-9530-dbafe3937a80"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["24393"]},"metadata":{},"execution_count":15}]},{"cell_type":"markdown","source":["# Tokenizer"],"metadata":{"id":"04nWxPYlMMPs"}},{"cell_type":"code","source":["tokens = tokenizer.encode(all_news, add_special_tokens=True)\n","tokens = np.array(tokens)\n","print(len(tokens))\n","tokens[:10]"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"jJptOapKKldz","executionInfo":{"status":"ok","timestamp":1639142705768,"user_tz":-180,"elapsed":925,"user":{"displayName":"Юлия Реброва","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiY2K6Fih802Mm_DFM09AvsLU6dMgzrZvTtTbmSug=s64","userId":"11804329915006949566"}},"outputId":"4f5c3799-65f5-4293-e4e7-597d0e342126"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["5339\n"]},{"output_type":"execute_result","data":{"text/plain":["array([ 1295,  9853,   401, 25824, 15734,  2206,  3193,  7295, 35436,\n","        2665])"]},"metadata":{},"execution_count":16}]},{"cell_type":"code","source":["l = len(tokens)//15\n","train = []\n","test = []\n","for i in range(15):\n","    if i%5 > 0:\n","        train.extend(tokens[i*l: (i+1)*l])\n","    else:\n","        test.extend(tokens[i*l: (i+1)*l])\n","train = np.array(train)\n","test = np.array(test)\n","\n","print(len(tokens), len(train), len(test))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"LFqO92BRM0gT","executionInfo":{"status":"ok","timestamp":1639142707184,"user_tz":-180,"elapsed":5,"user":{"displayName":"Юлия Реброва","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiY2K6Fih802Mm_DFM09AvsLU6dMgzrZvTtTbmSug=s64","userId":"11804329915006949566"}},"outputId":"885b2e0e-59e8-4436-a02c-0934f685c773"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["5339 4260 1065\n"]}]},{"cell_type":"markdown","source":["# Transformer"],"metadata":{"id":"GVxtke0UNAkf"}},{"cell_type":"code","source":["# torch.load(model, '/content/drive/MyDrive/Colab_Notebooks/news/news_gpt3.pt') #uncomment if you already have learned tho model"],"metadata":{"id":"3Q5xqzEKSXFl"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["from transformers import GPT2LMHeadModel, AdamW\n","\n","\n","model = GPT2LMHeadModel.from_pretrained(\n","    'sberbank-ai/rugpt3small_based_on_gpt2',\n","    output_attentions = False,\n","    output_hidden_states = False,\n",")\n","\n","model.to(device);"],"metadata":{"id":"oKPZ_hBlM6Qi"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["batch_size = 8\n","max_len = 70\n","epochs = 5\n","\n","n_train = len(train)//(batch_size*max_len)\n","n_test = len(test)//(batch_size*max_len)\n","print(n_train, n_test)\n","\n","optimizer = AdamW(model.parameters(), lr = 1e-5, eps = 1e-8)\n","\n","total_steps = n_train * epochs\n","scheduler = transformers.get_linear_schedule_with_warmup(optimizer, \n","                                            num_warmup_steps = 0, # Default value in run_glue.py\n","                                            num_training_steps = total_steps)\n","\n","\n","def accuracy(y_true, logits):\n","    return torch.mean((y_true[1:] == torch.argmax(logits, dim=2)[:-1]).float()).detach().cpu().numpy()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"fUlaUxR8M_qi","executionInfo":{"status":"ok","timestamp":1639142722027,"user_tz":-180,"elapsed":587,"user":{"displayName":"Юлия Реброва","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiY2K6Fih802Mm_DFM09AvsLU6dMgzrZvTtTbmSug=s64","userId":"11804329915006949566"}},"outputId":"91716ef1-45c8-4512-98d5-4ca2c5e1c186"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["7 1\n"]}]},{"cell_type":"code","source":["def prep_tensors(x, i, batch_size=batch_size, max_len=max_len):\n","    batch_ids = x[i*batch_size*max_len: (i+1)*batch_size*max_len]\n","    batch_ids = batch_ids.reshape(batch_size, max_len)\n","    batch_ids = torch.tensor(batch_ids).to(device)\n","    return batch_ids\n","\n","\n","for epoch in range(1, epochs+1):\n","    print(f'epoch {epoch}/{epochs} : training')\n","\n","    train_loss = []\n","    train_acc = []\n","    model.train()\n","    pbar = tqdm(range(n_train))\n","    for i in pbar:\n","        batch_ids = prep_tensors(train, i)\n","\n","        model.zero_grad()\n","        loss, logits, _ = model(batch_ids,\n","                             token_type_ids=None, \n","                            #  attention_mask=batch_mask,\n","                             labels=batch_ids\n","                             ).values()\n","\n","        loss.backward()\n","        torch.nn.utils.clip_grad_norm_(model.parameters(), 1.0)\n","        optimizer.step()\n","        scheduler.step()\n","        \n","        train_loss.append(loss.item())\n","        train_acc.append(accuracy(batch_ids, logits))\n","        pbar.set_description(f'acc {np.mean(train_acc):.4f} loss {np.mean(train_loss):.4f}', refresh=True)\n","\n","    \n","    print(f'epoch {epoch}/{epochs} : validation')\n","    model.eval()\n","    val_acc = []\n","    val_loss = []\n","    pbar = tqdm(range(n_test))\n","    for i in pbar:\n","        batch_ids = prep_tensors(test, i)\n","        with torch.no_grad():        \n","            loss, logits, _ = model(batch_ids, \n","                                token_type_ids=None, \n","                                # attention_mask=batch_mask,\n","                                labels=batch_ids\n","                                 ).values()\n","        \n","        val_loss.append(loss.item())\n","        val_acc.append(accuracy(batch_ids, logits))\n","        pbar.set_description(f'acc {np.mean(val_acc):.4f} loss {np.mean(val_loss):.4f}', refresh=True)\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":507,"referenced_widgets":["e6432927284d475ca29d0e61df264ca1","ce0caad5736846be881fa1793295b4ee","c6361020909d400eb6c1694ad09fced1","1b730d7709854e5392593efa6d619b4d","915f9491ee4c4aa1be7fec6a08f70d1b","6e8b1f900a584f7e9841768cc1c821a5","4f667b0ea4184022a7ce7741003b5436","976f967365a744eda02f9b7bf06489a1","b131c9e7992a4e97a941b1e7e41daafe","f258f80b73074820ad2d53c6a5e2dbce","97863e4db82f4c5a901cd6b3647393c2","3a074c39665b4ab7afdfcf3169053737","c4c5c7f9bf7347549b2b9ff06b23d312","9dec1d0a81214442b62fc090be53a4a8","3d7b556f993e4181a445f822550d588d","9d41bb76c2104022bfd1bd3ec76845b0","e1aa85ac42714d0db021b1030dcf759f","5cd1698d0e3f4880a0f8a751abe894b1","d01863b32134474bbe965b6d733b1d5a","3c3cc5eb003d4099977a7cee18d52e63","7556c8a9e80b481f9cfb0db0d349a777","3cc622da64c14e4db211bbb583eac748","3cec1ec6a68846cea980bf92e9076c5d","47cbff0f8de44184a7e387b9da9325fd","5607dd1454764abeb2c2c5e961ae6e2c","e1b09b75670444a6a4a799e1746c74af","0243958fafe54587a9da96ad88cd19e0","1194b9d54a5e42dfb7d38d880b0ae203","b4c3a768d6544585ae95dfe593c9492a","db1e1a2ef3ba4d53b457838c8a0730db","b1ede558fa4f483ba14b55b0a38f166d","a825d8517ebb43ec9633ea12e0e9c4f6","55a118a1b4b844e4a6d9cc6835684239","00aa5e4d12ef4a409b9f67f52c861de7","1f87eccd4d7f4d8c8ca4a792b682102c","4553a257f14243a591c1e8e4d9e7b272","fc4d0393a43d4a90966be405f6425ebb","4dff0b2149c74ea299f2caf17a215d2f","57dc94672e8243d7bc36e2e99757148d","006bf08077ab4750b1a9c4bf044c68e7","ad4c9192ee4843a9a0b1f14313b194ef","fe73e1cc0ffd4d11b99ed435f7acc297","d653ce6bae9847c995b1f3dec2fd3221","3e4078e176b64d81b72c510da2771b03","e6a6e70941b84cefa7dd01b9f8b9d89a","e93f06e670524af6a5a11dae1ed8ff00","28999912d33c42a688913b9f4a6dd7b9","7bac386fc9fc46ef8897bc4cfc71c59e","06d77554ed9e448292584ed28685ec60","239502f34acb458ca668c5b96d3ac1be","c769e9dab473400e8064c40247fda7cf","6eeb5391803440d6a3b6745ca1ac0263","bec07ad667a74c6ca6c2e2e395478de1","0e26bf40d7484edfac4dc2eb90044852","a202c59f852047b0afe48b9a77b09629","e8df68e4d64c49d5929219d75d601467","1ef184d4694b43aab4768e221145a8b6","c594dee71a04497688cc4429706c7938","e125247918d447de9bad39050ae52b91","c8e7dc4ccd2a409fba637d0828c0a9aa","43408246c7804197bb8298535bb3ffe0","cf5c90e43c144b76b7f1eeeac55c282b","4b523ec8d8bd4dda82b6e3a3c53c8eb8","5960f5d736ee4253bf9409caa8c2f270","044ca029f3d54e7495881188613b9e13","aea82bf27fbb47afba1dbbfd933e0cd7","7a6f0a3b3f0a4819899d057f2fe87326","b26b9794cf654e09bd56724985f63a0d","70264fe3121b4058991a4abba5f86222","da3788d2846846c0a642f3498f84bd63","c858791b1639443ea36ad39de9e5de95","4b73f0bd8941433e82ef70b3a81ef0ad","d4fa3bc9c24a4806ab22297b93d54989","559683dc66b64ceb971915c6cee644a3","19195a2345e240e69031bede8aec60b1","03ef2ae4fe424cc6b618e062b97632d8","8253780cd8134b029df83342b96ce0c9","a23bb759c7b3456fa0fb0478e28de9bd","9ca9dfda91b445a28b9dfab44b6b505c","ad840afae12b4189b43d3467222f8531","ab4648d3aa674e55be882d7f3b1db1a1","e7259b0fcf6841a291aa57f17eea5cb8","f1e0ef2a3411411e8583afed3f5ebaec","60f906f725da4908a7925f8554768232","2703a5a078b84c418371cc1ace988bd1","ee0ab8ff18354c4eac9e14787866d045","31ff9478e1f14dd7a83b1fca70d51888","2d9bcd5a8243454fa87c466cbdfc9d4a","7e5a5dd4c84a4c3ebabea557b12bc16a","7e8d4e8dae614f178a523c37ed16a8b5","00f0ac2385274792a129c45e9cb64775","abcc8a1174c14f769089d53703e48f75","c87c242cf5b6411b8e7cedab90aff89f","1a04c7f6b29b4916bc4555bfffb60767","97ab9afa45cf4d04888448147417071d","56f810a6db9c47968c1c061799e26e4e","70b289155d414dc2a4f44375617aab89","c7bc9745df1e4c9d90c987b48c5850a5","c2a6a13e1b2c464bbee8ecae1c7de7c0","9469a2d414404ac48d059632789b0ac3","190b00b2193a4750ad630b3d160908b3","1046cfacc8c64b298dab259c4f8313f2","3c02422a74b34b6898f7ee986d7f01bd","52fc041d8d864791a5b82403ba376d54","755e18cd91fe44d0917eb85b2c40dd7a","98219781b6d64d6fb3e69fe9c6b10595","48dca50b8e5549ce8650bf4933ad7b56","fa1374f240354105a28704b12e6e24cd","c0e353aafba74482b936323187e66b4b","a8516e26c029447e99f1d3bd806115db"]},"id":"fpFWrSCJNN24","executionInfo":{"status":"ok","timestamp":1639142731593,"user_tz":-180,"elapsed":5504,"user":{"displayName":"Юлия Реброва","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiY2K6Fih802Mm_DFM09AvsLU6dMgzrZvTtTbmSug=s64","userId":"11804329915006949566"}},"outputId":"12efe7ea-7e13-4ca2-dd5d-19826cded5a8"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["epoch 1/5 : training\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"e6432927284d475ca29d0e61df264ca1","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/7 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["epoch 1/5 : validation\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"3a074c39665b4ab7afdfcf3169053737","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/1 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["epoch 2/5 : training\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"3cec1ec6a68846cea980bf92e9076c5d","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/7 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["epoch 2/5 : validation\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"00aa5e4d12ef4a409b9f67f52c861de7","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/1 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["epoch 3/5 : training\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"e6a6e70941b84cefa7dd01b9f8b9d89a","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/7 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["epoch 3/5 : validation\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"e8df68e4d64c49d5929219d75d601467","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/1 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["epoch 4/5 : training\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"7a6f0a3b3f0a4819899d057f2fe87326","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/7 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["epoch 4/5 : validation\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"a23bb759c7b3456fa0fb0478e28de9bd","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/1 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["epoch 5/5 : training\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"7e5a5dd4c84a4c3ebabea557b12bc16a","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/7 [00:00<?, ?it/s]"]},"metadata":{}},{"output_type":"stream","name":"stdout","text":["epoch 5/5 : validation\n"]},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"9469a2d414404ac48d059632789b0ac3","version_minor":0,"version_major":2},"text/plain":["  0%|          | 0/1 [00:00<?, ?it/s]"]},"metadata":{}}]},{"cell_type":"markdown","source":["# Generate"],"metadata":{"id":"2WxchNOvPQvP"}},{"cell_type":"code","source":["def generate_news(start_words):\n","  start_words = tokenizer.encode(start_words, return_tensors='pt').to(device)\n","  out = model.generate(\n","    input_ids=start_words,\n","    max_length=50,\n","    num_beams=5,\n","    do_sample=True,\n","    temperature=7.,\n","    top_k=55,\n","    top_p=0.6,\n","    no_repeat_ngram_size=4,\n","    num_return_sequences=1,\n","    ).cpu().numpy()\n","  return del_xa(re.sub('\\n', '', tokenizer.decode(out[0])))\n"],"metadata":{"id":"1_xMaRu4Nglu"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["Try to generate news"],"metadata":{"id":"pOSjniMbmahR"}},{"cell_type":"code","source":["generate_news('В россии ')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":142},"id":"7MJcAGpyOdkR","executionInfo":{"status":"ok","timestamp":1639142761962,"user_tz":-180,"elapsed":901,"user":{"displayName":"Юлия Реброва","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiY2K6Fih802Mm_DFM09AvsLU6dMgzrZvTtTbmSug=s64","userId":"11804329915006949566"}},"outputId":"7f0081b5-7696-4599-bde9-739bf86c5d9c"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["Setting `pad_token_id` to `eos_token_id`:50256 for open-end generation.\n","/usr/local/lib/python3.7/dist-packages/transformers/generation_utils.py:2158: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').\n","  next_indices = next_tokens // vocab_size\n"]},{"output_type":"execute_result","data":{"application/vnd.google.colaboratory.intrinsic+json":{"type":"string"},"text/plain":["'В россии   В начале мая 2015 Путин в Сочи впервые предложил России помощь в расследовании катастрофы с крушением Audi «В России обсудили вопрос развития оборонки«Россия, которая должна защищать людей» «Путин предложил НАТО начать войну с'"]},"metadata":{},"execution_count":23}]},{"cell_type":"code","source":["# torch.save(model, '/content/drive/MyDrive/Colab_Notebooks/news/news_gpt3.pt') # uncomment to save model after training"],"metadata":{"id":"6sDSSSDtOKKs"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["\n","# quite good params for model\n","# max_length=50,\n","#     num_beams=5,\n","#     do_sample=True,\n","#     temperature=8.,\n","#     top_k=55,\n","#     top_p=0.6,\n","#     no_repeat_ngram_size=4,\n","#     num_return_sequences=1,\n","#     ).cpu().numpy()"],"metadata":{"id":"4CCANs4JPozv"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":[" # Interface"],"metadata":{"id":"nXUXOqN0RzJd"}},{"cell_type":"code","source":["pip install gradio"],"metadata":{"id":"-ZpQfeCrRSgr"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import gradio as gr"],"metadata":{"id":"9DPTDe_MR2LT"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["iface = gr.Interface(fn=generate_news, inputs=[\"text\"], outputs=\"text\").launch()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":589},"id":"_9TnVfw_R4kL","executionInfo":{"status":"ok","timestamp":1639140441374,"user_tz":-180,"elapsed":4119,"user":{"displayName":"Юлия Реброва","photoUrl":"https://lh3.googleusercontent.com/a-/AOh14GiY2K6Fih802Mm_DFM09AvsLU6dMgzrZvTtTbmSug=s64","userId":"11804329915006949566"}},"outputId":"6c35480d-c580-4deb-d019-17a7eccd9217"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Colab notebook detected. To show errors in colab notebook, set `debug=True` in `launch()`\n","Running on public URL: https://16046.gradio.app\n","\n","This share link will expire in 72 hours. To get longer links, send an email to: support@gradio.app\n"]},{"output_type":"display_data","data":{"text/html":["\n","        <iframe\n","            width=\"900\"\n","            height=\"500\"\n","            src=\"https://16046.gradio.app\"\n","            frameborder=\"0\"\n","            allowfullscreen\n","        ></iframe>\n","        "],"text/plain":["<IPython.lib.display.IFrame at 0x7f846469ea50>"]},"metadata":{}}]}]}